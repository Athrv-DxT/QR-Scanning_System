<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Scanner</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body>

    <div class="container">
        <h2>Scan QR Code</h2>
        <input type="text" id="room" placeholder="Enter Room ID">
        <button onclick="startScanner()">Start Scanner</button>
        <div id="reader"></div>
    </div>

    <script>
        let roomID = "";

        function sendToServer(name) {
            fetch("https://your-backend.onrender.com/scan", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ room_id: roomID, name: name })
            }).then(response => response.json())
              .then(data => console.log("Server Response:", data))
              .catch(error => console.error("Error:", error));
        }

        function onScanSuccess(decodedText) {
            if (!roomID) {
                alert("Enter a Room ID first!");
                return;
            }
            sendToServer(decodedText);
        }

        function startScanner() {
            roomID = document.getElementById("room").value;
            if (!roomID) {
                alert("Enter a Room ID first!");
                return;
            }
            let scanner = new Html5Qrcode("reader");
            scanner.start(
                { facingMode: "environment" },
                { fps: 10, qrbox: 250 },
                onScanSuccess
            );
        }
    </script>

</body>
</html>
